var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var start=function(){playMeasure&&(document.getElementById("start").outerHTML="",document.getElementById("pause").disabled=!1,play())},play=function(a){a&&(document.getElementById("pause").style.display="inline",document.getElementById("play").style.display="none");playMeasure(restart_point,a)},pause=function(){document.getElementById("pause").style.display="none";document.getElementById("play").style.display="inline";timeouts.forEach(clearTimeout)},playMeasure,VF,context,notation_div,length,x_pos=
0,measure_width=150,staves,clefs=["treble","bass","bass"],flats=["A","B","D","E"],voice_cache={},annotation_age,current_dynamic,dynamic_age=0,base_tempo=1.1,tempo=base_tempo,tempo_variance=1,measure_length=1920,track_options=[{gain:1,sustain:1,gain_center:1},{gain:.3,sustain:1,gain_center:.3}],timeouts=[],restart_point=starts;window.onload=function(){VF=Vex.Flow;length=.95*innerWidth;notation_div=document.getElementById("notation");render_staves();createPiano()};
function weighted_random(a){for(var b=[],c=Object.keys(a),d=0;d<c.length;d++){var e=c[d],f=a[e];for(j=0;j<f;j++)b.push(e)}return b[Math.floor(Math.random()*b.length)]};var starts=["72/100/480/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0","41/100/0/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0"],dists=[{"72/100/480/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0":{"72/100/1/51|72/0/51/0|71/100/1/906|71/0/906/0|72/100/2/51|72/0/51/0|71/100/1/860|71/0/860/0":1},"72/100/265/239|72/0/239/0|74/100/1/239|74/0/239/0|76/100/1/239|76/0/239/0|77/100/1/239|77/0/239/0|79/100/1/239|79/0/239/0|83/100/1/239|83/0/239/0|79/100/1/239|79/0/239/0":{"77/100/1/479|77/0/479/0|79/100/1/51|79/0/51/0|77/100/1/1386|77/0/1386/0":4},
"77/100/1/479|77/0/479/0|79/100/1/51|79/0/51/0|77/100/1/1386|77/0/1386/0":{"79/100/2/51|79/0/51/0|77/100/1/906|77/0/906/0|77/100/2/51|77/0/51/0|76/100/1/906|76/0/906/0":4},"68/100/96/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":{"68/100/2/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":1},"68/100/0/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":{"68/100/2/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":1},
"73/100/2/51|73/0/51/0|72/100/1/906|72/0/906/0|72/100/2/51|72/0/51/0|71/100/1/906|71/0/906/0":{"68/100/0/51|68/0/51/0|67/100/1/426|67/0/426/0|67/100/2/51|67/0/51/0|65/100/1/1363|65/0/1363/0":1,"68/100/2/51|68/0/51/0|67/100/1/426|67/0/426/0|67/100/2/51|67/0/51/0|65/100/1/1363|65/0/1363/0":3},"68/100/25/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":{"68/100/2/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":6},"68/100/0/51|68/0/51/0|67/100/1/426|67/0/426/0|67/100/2/51|67/0/51/0|65/100/1/1363|65/0/1363/0":{"70/0/0/1920":2},
"76/100/1/51|76/0/51/0|77/100/1/906|77/0/906/0|76/100/2/51|76/0/51/0|77/100/1/860|77/0/860/0":{"72/100/528/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0":2},"65/100/2/51|65/0/51/0|67/100/1/426|67/0/426/0|65/100/2/51|65/0/51/0|67/100/1/1134|67/0/1134/0":{"68/100/254/51|68/0/51/0|67/100/1/404|67/0/404/0|67/100/24/51|67/0/51/0|65/100/1/1363|65/0/1363/0":2},"79/100/2/51|79/0/51/0|77/100/1/906|77/0/906/0|77/100/2/51|77/0/51/0|76/100/1/906|76/0/906/0":{"73/100/2/51|73/0/51/0|72/100/1/906|72/0/906/0|72/100/2/51|72/0/51/0|71/100/1/906|71/0/906/0":4},
"72/100/1/51|72/0/51/0|71/100/1/906|71/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":{"65/100/2/51|65/0/51/0|67/100/1/426|67/0/426/0|65/100/2/51|65/0/51/0|67/100/1/1134|67/0/1134/0":1},"68/100/2/51|68/0/51/0|67/100/1/426|67/0/426/0|67/100/2/51|67/0/51/0|65/100/1/1363|65/0/1363/0":{"70/0/0/1920":9},"72/100/505/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0":{"72/100/1/51|72/0/51/0|71/100/1/906|71/0/906/0|72/100/2/51|72/0/51/0|71/100/1/860|71/0/860/0":1},
"70/0/0/1920":{"68/100/25/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":6,"72/100/505/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0":2,"68/100/0/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":1,"72/100/265/239|72/0/239/0|74/100/1/239|74/0/239/0|76/100/1/239|76/0/239/0|77/100/1/239|77/0/239/0|79/100/1/239|79/0/239/0|83/100/1/239|83/0/239/0|79/100/1/239|79/0/239/0":4},"72/100/528/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0":{"76/100/1/51|76/0/51/0|77/100/1/906|77/0/906/0|76/100/2/51|76/0/51/0|77/100/1/860|77/0/860/0":2,
"72/100/1/51|72/0/51/0|71/100/1/906|71/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":1,"72/100/0/51|72/0/51/0|71/100/1/906|71/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":1},"72/100/0/51|72/0/51/0|71/100/1/906|71/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":{"65/100/2/51|65/0/51/0|67/100/1/426|67/0/426/0|65/100/2/51|65/0/51/0|67/100/1/1134|67/0/1134/0":1},"68/100/2/51|68/0/51/0|70/100/1/906|70/0/906/0|68/100/2/51|68/0/51/0|67/100/1/906|67/0/906/0":{"68/100/0/51|68/0/51/0|67/100/1/426|67/0/426/0|67/100/2/51|67/0/51/0|65/100/1/1363|65/0/1363/0":1,
"68/100/2/51|68/0/51/0|67/100/1/426|67/0/426/0|67/100/2/51|67/0/51/0|65/100/1/1363|65/0/1363/0":6},"72/100/1/51|72/0/51/0|71/100/1/906|71/0/906/0|72/100/2/51|72/0/51/0|71/100/1/860|71/0/860/0":{"72/100/528/239|72/0/239/0|75/100/1/239|75/0/239/0|74/100/1/479|74/0/479/0|72/100/1/479|72/0/479/0":2},"68/100/254/51|68/0/51/0|67/100/1/404|67/0/404/0|67/100/24/51|67/0/51/0|65/100/1/1363|65/0/1363/0":{"70/0/0/1920":2}},{"41/100/0/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":{"41/100/25/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":1},
"41/100/25/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":{"34/100/25/1823|53/100/480/911|58/100/0/911|61/100/0/911|53/0/911/0|58/0/0/0|61/0/0/0|53/100/49/455|58/100/0/455|61/100/0/455|34/0/383/0|53/0/72/0|58/0/0/0|61/0/0/0":1,"41/100/25/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":32,
"48/100/25/1823|51/100/480/911|55/100/0/911|60/100/0/911|51/0/911/0|55/0/0/0|60/0/0/0|51/100/49/455|55/100/0/455|60/100/0/455|48/0/383/0|51/0/72/0|55/0/0/0|60/0/0/0":2},"41/100/25/1823|56/100/480/911|60/100/0/911|65/0/0/0|65/100/0/960|56/0/911/0|60/0/0/0|56/100/49/455|60/100/0/455|65/0/0/0|65/100/0/-1465|41/0/383/0|56/0/72/0|60/0/0/0":{"34/100/25/1823|53/100/480/911|58/100/0/911|61/100/0/911|53/0/911/0|58/0/0/0|61/0/0/0|53/100/49/455|58/100/0/455|61/100/0/455|34/0/383/0|53/0/72/0|58/0/0/0|61/0/0/0":7,
"41/100/25/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":6},"48/100/25/1823|51/100/480/911|55/100/0/911|60/100/0/911|51/0/911/0|55/0/0/0|60/0/0/0|51/100/49/455|55/100/0/455|60/100/0/455|48/0/383/0|51/0/72/0|55/0/0/0|60/0/0/0":{"41/100/25/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":2},
"34/100/25/1823|53/100/480/911|58/100/0/911|61/100/0/911|53/0/911/0|58/0/0/0|61/0/0/0|53/100/49/455|58/100/0/455|61/100/0/455|34/0/383/0|53/0/72/0|58/0/0/0|61/0/0/0":{"34/100/25/1823|53/100/480/911|58/100/0/911|61/100/0/911|53/0/911/0|58/0/0/0|61/0/0/0|53/100/49/455|58/100/0/455|61/100/0/455|34/0/383/0|53/0/72/0|58/0/0/0|61/0/0/0":8,"41/100/25/1823|56/100/480/911|60/100/0/911|65/100/0/911|56/0/911/0|60/0/0/0|65/0/0/0|56/100/49/455|60/100/0/455|65/100/0/455|41/0/383/0|56/0/72/0|60/0/0/0|65/0/0/0":7}}];function render_staves(){var a=window.innerHeight+window.scrollY>=document.body.offsetHeight,b=new VF.Renderer(notation_div,VF.Renderer.Backends.SVG);b.resize(length,300);context=b.getContext();staves=[new VF.Stave(40,30,length,{right_bar:!1}),new VF.Stave(40,140,length,{right_bar:!1}),new VF.Stave(40,140,length,{right_bar:!1})];x_pos=115;for(b=0;b<staves.length;b++)staves[b].addClef(clefs[b]),staves[b].addKeySignature("Ab"),staves[b].setContext(context).draw(),staves[b].setNoteStartX(x_pos);b=new VF.StaveConnector(staves[0],
staves[1]);var c=new VF.StaveConnector(staves[0],staves[1]);b.setType(VF.StaveConnector.type.BRACE);b.setContext(context);b.setContext(context);b.draw();c.setType(VF.StaveConnector.type.SINGLE);c.setContext(context);c.draw();a&&window.scrollTo(0,document.body.scrollHeight)}
function drawNotes(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=voice_cache[a[e]];f||(f=a[e].split("|"),f=get_voice(f,clefs[e]),voice_cache[a[e]]=f);d=d.concat(f)}a=new VF.Formatter;a.joinVoices([d[0]]);a.joinVoices([d[1],d[2]]);a.format(d,measure_width);e=function(a){return a.setContext(context).draw()};for(f=0;f<d.length;f++){staves[f].setNoteStartX(x_pos);var h=VF.Beam.generateBeams(d[f].getTickables(),{flat_beams:!0,stem_direction:1<=f?-1:1});d[f].draw(context,staves[f]);h.forEach(e)}b&&(b=new VF.TextDynamics({text:b,
duration:"w"}),b=(new VF.Voice({num_beats:4,beat_value:4})).addTickable(b),a.format([b],measure_width),b.draw(context,staves[1]));c&&(text_note=(new VF.TextNote({text:c,duration:"w"})).setLine(-1).setJustification(VF.TextNote.Justification.LEFT).setStave(staves[0]),text_note.font={family:"Georgia",size:14},c=(new VF.Voice({num_beats:4,beat_value:4})).addTickable(text_note),a.format([c],measure_width),c.draw(context,staves[0]))}
function get_voice(a,b){a=a.filter(function(a){if(0<a.split("/")[3])return a});for(var c=[],d=[],e,f=!0,h=0;h<a.length;h++){var g="bass"==b?"b/3":"e/5";if("70/0/0/1920"==a[h]){c.push(new VF.StaveNote({clef:b,keys:[g],duration:"wr"}));break}note=a[h].split("/");if(f&&25<note[2]&&60<note[3]){var l=get_duration(note[2]-50)+"r";c.push(new VF.StaveNote({clef:b,keys:[g],duration:l}))}l=midi_to_note(note[0]);var k=parseInt(note[3]);g=get_duration(k);if(100>k)g=new Vex.Flow.GraceNote({keys:[l],duration:"8",
slash:!0}),e=new Vex.Flow.GraceNoteGroup([g],!0),-1<flats.indexOf(l.split("/")[0])&&g.addAccidental(0,new VF.Accidental("n"));else{for(l=[l];;){k=a[h+1]?a[h+1].split("/"):void 0;if(!k||0<k[2]||0===k[1])break;h+=1;k=midi_to_note(k[0]);l.push(k)}k={clef:b,keys:l,duration:g};k.stem_direction="bass"==b==1?-1:1;k=new VF.StaveNote(k);e&&(k.addModifier(0,e.beamNotes()),e=void 0);"hd"==g&&k.addDotToAll();1==l.length&&-1<flats.indexOf(l[0].split("/")[0])&&k.addAccidental(0,new VF.Accidental("n"));"w"==g?d.push(k):
(c.push(k),f=!1)}}a=new VF.Voice({num_beats:4,beat_value:4});a.addTickables(c);c=[a];0<d.length&&(a=new VF.Voice({num_beats:4,beat_value:4}),a.addTickables(d),c.push(a));return c}function get_duration(a){var b="w";240>=a?b="8":480>=a?b="q":960>=a?b="h":1774>=a&&(b="hd");return b}function midi_to_note(a){return"C Db D Eb E F Gb G Ab A Bb B".split(" ")[a%12]+"/"+(Math.floor(a/12)-1)};var grammar_data={intro:["so as to","don't"],adverb:["very","lightly","healthily","rigorously","diligently"],verb:"have;ask;wonder about;consider;ponder;mediate;desecrate;meditate on;reject;bury;conceal;request;defer to;listen to;ignore;repudiate;light;open;widen;experiment with;console;secrete;deliver;obtain;collect;spread out;expand;join;interrogate;answer".split(";"),noun:"humility;joy;despondence;loneliness;sadness;conviction;clarity;walls;air;water;darkness;benevolence;ill intent;questions;trepidation;fear;tranquility;clairvoyance;wit;a hole;the sound;your head;your body;your hands;yourself;superiority;ingenuity".split(";"),
adjective:"calm gaunt moderate slow alone placid turgid transformed translucent ingenious pensive forgetful resourceful illuminated lost lonely transparent liquid kind polite pensive magisterial bureaucratic timid benevolent proud wise lustrous nostalgic indulgent reticent secretive".split(" ")};function choose_word(a,b){if(!(Math.random()<b))return a[Math.floor(Math.random()*a.length)]}
function get_annotation(){var a=Math.random();a=.4>a?[choose_word(grammar_data.intro,.8),choose_word(grammar_data.verb),choose_word(grammar_data.noun)]:.8>a?[choose_word(["with","in"]),choose_word(grammar_data.noun)]:[choose_word(grammar_data.intro,.6),"be",choose_word(grammar_data.adverb,.5),choose_word(grammar_data.adjective)];a=a.join(" ").trim();return a.charAt(0).toUpperCase()+a.slice(1)};function createPiano(){Soundfont.instrument(new AudioContext,"acoustic_grand_piano").then(function(a){var b=function(c,d,e){tempo+=tempo_variance*(tempo>base_tempo?-.01:.001);var f=track_options[e];track_options[e].gain=f.gain>f.gain_center?track_options[e].gain-f.gain/400:track_options[e].gain+f.gain/400;var h=c[d].split("/"),g=[];if(0<h[1]){for(g.push(h[0]);;){h=c[d+1]?c[d+1].split("/"):void 0;if(!h||0<h[2]||0===h[1])break;d+=1;g.push(h[0])}for(h=0;h<g.length;h++)a.play(g[h],0,f)}c[d+1]&&(f=c[d+
1].split("/"),timeouts.push(window.setTimeout(b.bind(null,c,d+1,e),f[2]*tempo)))};playMeasure=function(a,d){restart_point=a;timeouts.forEach(clearTimeout);timeouts=[];tempo+=tempo_variance*(.5-Math.random())/8;if(!current_dynamic||5<dynamic_age){dynamic_age=0;var c=current_dynamic="p"==current_dynamic?"f":"p";track_options[0].gain="p"==current_dynamic?.5:1.9;track_options[1].gain="p"==current_dynamic?.2:.8}else dynamic_age+=1;if(void 0===annotation_age||17<annotation_age){var f=get_annotation();annotation_age=
0}annotation_age+=1;for(var h=[],g=0;g<a.length;g++)h.push(a[g].split("|"));for(g=0;g<a.length;g++){var l=h[g],k=l[0].split("/");timeouts.push(window.setTimeout(b.bind(null,l,0,g),k[2]*tempo))}d||(drawNotes(a,c,f),x_pos+=measure_width);d=[];for(g=0;g<a.length;g++)d.push(weighted_random(dists[g][a[g]]));x_pos>length-measure_width&&render_staves();timeouts.push(window.setTimeout(playMeasure.bind(null,d),measure_length*tempo))};document.getElementById("start").removeAttribute("disabled")})};
